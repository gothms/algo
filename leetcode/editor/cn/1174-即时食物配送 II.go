//é…é€è¡¨: Delivery
//
// +-----------------------------+---------+
//| Column Name                 | Type    |
//+-----------------------------+---------+
//| delivery_id                 | int     |
//| customer_id                 | int     |
//| order_date                  | date    |
//| customer_pref_delivery_date | date    |
//+-----------------------------+---------+
//delivery_id æ˜¯è¡¨çš„ä¸»é”®ã€‚
//è¯¥è¡¨ä¿å­˜ç€é¡¾å®¢çš„é£Ÿç‰©é…é€ä¿¡æ¯ï¼Œé¡¾å®¢åœ¨æŸä¸ªæ—¥æœŸä¸‹äº†è®¢å•ï¼Œå¹¶æŒ‡å®šäº†ä¸€ä¸ªæœŸæœ›çš„é…é€æ—¥æœŸï¼ˆå’Œä¸‹å•æ—¥æœŸç›¸åŒæˆ–è€…åœ¨é‚£ä¹‹åï¼‰ã€‚
//
//
//
//
// å¦‚æœé¡¾å®¢æœŸæœ›çš„é…é€æ—¥æœŸå’Œä¸‹å•æ—¥æœŸç›¸åŒï¼Œåˆ™è¯¥è®¢å•ç§°ä¸º ã€Œå³æ—¶è®¢å•ã€ï¼Œå¦åˆ™ç§°ä¸ºã€Œè®¡åˆ’è®¢å•ã€ã€‚
//
// ã€Œé¦–æ¬¡è®¢å•ã€æ˜¯é¡¾å®¢æœ€æ—©åˆ›å»ºçš„è®¢å•ã€‚æˆ‘ä»¬ä¿è¯ä¸€ä¸ªé¡¾å®¢åªä¼šæœ‰ä¸€ä¸ªã€Œé¦–æ¬¡è®¢å•ã€ã€‚
//
// å†™ä¸€æ¡ SQL æŸ¥è¯¢è¯­å¥è·å–å³æ—¶è®¢å•åœ¨æ‰€æœ‰ç”¨æˆ·çš„é¦–æ¬¡è®¢å•ä¸­çš„æ¯”ä¾‹ã€‚ä¿ç•™ä¸¤ä½å°æ•°ã€‚
//
//
//
// æŸ¥è¯¢ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š
//
// Delivery è¡¨ï¼š
//+-------------+-------------+------------+-----------------------------+
//| delivery_id | customer_id | order_date | customer_pref_delivery_date |
//+-------------+-------------+------------+-----------------------------+
//| 1           | 1           | 2019-08-01 | 2019-08-02                  |
//| 2           | 2           | 2019-08-02 | 2019-08-02                  |
//| 3           | 1           | 2019-08-11 | 2019-08-12                  |
//| 4           | 3           | 2019-08-24 | 2019-08-24                  |
//| 5           | 3           | 2019-08-21 | 2019-08-22                  |
//| 6           | 2           | 2019-08-11 | 2019-08-13                  |
//| 7           | 4           | 2019-08-09 | 2019-08-09                  |
//+-------------+-------------+------------+-----------------------------+
//
//Result è¡¨ï¼š
//+----------------------+
//| immediate_percentage |
//+----------------------+
//| 50.00                |
//+----------------------+
//1 å·é¡¾å®¢çš„ 1 å·è®¢å•æ˜¯é¦–æ¬¡è®¢å•ï¼Œå¹¶ä¸”æ˜¯è®¡åˆ’è®¢å•ã€‚
//2 å·é¡¾å®¢çš„ 2 å·è®¢å•æ˜¯é¦–æ¬¡è®¢å•ï¼Œå¹¶ä¸”æ˜¯å³æ—¶è®¢å•ã€‚
//3 å·é¡¾å®¢çš„ 5 å·è®¢å•æ˜¯é¦–æ¬¡è®¢å•ï¼Œå¹¶ä¸”æ˜¯è®¡åˆ’è®¢å•ã€‚
//4 å·é¡¾å®¢çš„ 7 å·è®¢å•æ˜¯é¦–æ¬¡è®¢å•ï¼Œå¹¶ä¸”æ˜¯å³æ—¶è®¢å•ã€‚
//å› æ­¤ï¼Œä¸€åŠé¡¾å®¢çš„é¦–æ¬¡è®¢å•æ˜¯å³æ—¶çš„ã€‚
//
//
// Related Topics æ•°æ®åº“ ğŸ‘ 50 ğŸ‘ 0

package main

func main() {

}

//There is no code of Go type for this problem

SELECT ROUND(AVG(order_date = customer_pref_delivery_date)*100, 2) AS immediate_percentage FROM
(SELECT * FROM delivery WHERE (customer_id, order_date) IN (SELECT customer_id, MIN(order_date) FROM delivery GROUP BY customer_id)) AS t
