//ç»™ä½ ä¸€ä¸ªæ•°ç»„ points å’Œä¸€ä¸ªæ•´æ•° k ã€‚æ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ éƒ½è¡¨ç¤ºäºŒç»´å¹³é¢ä¸Šçš„ç‚¹çš„åæ ‡ï¼Œå¹¶æŒ‰ç…§æ¨ªåæ ‡ x çš„å€¼ä»å°åˆ°å¤§æ’åºã€‚ä¹Ÿå°±æ˜¯è¯´ points[i] =
// [xi, yi] ï¼Œå¹¶ä¸”åœ¨ 1 <= i < j <= points.length çš„å‰æä¸‹ï¼Œ xi < xj æ€»æˆç«‹ã€‚
//
// è¯·ä½ æ‰¾å‡º yi + yj + |xi - xj| çš„ æœ€å¤§å€¼ï¼Œå…¶ä¸­ |xi - xj| <= k ä¸” 1 <= i < j <= points.
//lengthã€‚
//
// é¢˜ç›®æµ‹è¯•æ•°æ®ä¿è¯è‡³å°‘å­˜åœ¨ä¸€å¯¹èƒ½å¤Ÿæ»¡è¶³ |xi - xj| <= k çš„ç‚¹ã€‚
//
//
//
// ç¤ºä¾‹ 1ï¼š
//
// è¾“å…¥ï¼špoints = [[1,3],[2,0],[5,10],[6,-10]], k = 1
//è¾“å‡ºï¼š4
//è§£é‡Šï¼šå‰ä¸¤ä¸ªç‚¹æ»¡è¶³ |xiÂ - xj| <= 1 ï¼Œä»£å…¥æ–¹ç¨‹è®¡ç®—ï¼Œåˆ™å¾—åˆ°å€¼ 3 + 0 + |1 - 2| = 4 ã€‚ç¬¬ä¸‰ä¸ªå’Œç¬¬å››ä¸ªç‚¹ä¹Ÿæ»¡è¶³æ¡ä»¶ï¼Œå¾—åˆ°å€¼ 1
//0 + -10 + |5 - 6| = 1 ã€‚
//æ²¡æœ‰å…¶ä»–æ»¡è¶³æ¡ä»¶çš„ç‚¹ï¼Œæ‰€ä»¥è¿”å› 4 å’Œ 1 ä¸­æœ€å¤§çš„é‚£ä¸ªã€‚
//
// ç¤ºä¾‹ 2ï¼š
//
// è¾“å…¥ï¼špoints = [[0,0],[3,0],[9,2]], k = 3
//è¾“å‡ºï¼š3
//è§£é‡Šï¼šåªæœ‰å‰ä¸¤ä¸ªç‚¹æ»¡è¶³ |xiÂ - xj| <= 3 ï¼Œä»£å…¥æ–¹ç¨‹åå¾—åˆ°å€¼ 0 + 0 + |0 - 3| = 3 ã€‚
//
//
//
//
// æç¤ºï¼š
//
//
// 2 <= points.length <= 10^5
// points[i].length == 2
// -10^8 <= points[i][0], points[i][1] <= 10^8
// 0 <= k <= 2 * 10^8
// å¯¹äºæ‰€æœ‰çš„1 <= i < j <= points.length ï¼Œpoints[i][0] < points[j][0] éƒ½æˆç«‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œxi æ˜¯ä¸¥æ ¼
//é€’å¢çš„ã€‚
//
//
// Related Topics é˜Ÿåˆ— æ•°ç»„ æ»‘åŠ¨çª—å£ å•è°ƒé˜Ÿåˆ— å †ï¼ˆä¼˜å…ˆé˜Ÿåˆ—ï¼‰ ğŸ‘ 66 ğŸ‘ 0

package main

import (
	"fmt"
	"math"
)

func main() {
	// -6
	points := [][]int{{-19, 9}, {-15, -19}, {-5, -8}}
	k := 10
	equation := findMaxValueOfEquation(points, k)
	fmt.Println(equation)
}

/*
æ€è·¯ï¼šä¼˜å…ˆé˜Ÿåˆ—
	1.å®šä¹‰å¤§é¡¶å †ä½œä¸ºä¼˜å…ˆé˜Ÿåˆ— type eq [][2]int
		[2]intï¼šç¬¬ä¸€ä¸ªå…ƒç´ å®šä¹‰ä¸º xi+yiï¼Œç¬¬äºŒä¸ªå…ƒç´ ä¸º i
	2.å¤§é¡¶å †çš„æ›´æ–°
		æˆ‘ä»¬å°†æ»¡è¶³ |xi - xj| <= kï¼ˆä¹Ÿå°±æ˜¯æ»¡è¶³ xj-xi<=kï¼‰çš„å…ƒç´ éƒ½æ”¾å…¥ä¸€ä¸ªä¼˜å…ˆé˜Ÿåˆ—ä¸­
		æ­¤å¤„æˆ‘ä»¬ä»¥ xi ä¸ºå½“å‰è¦å¤„ç†çš„å…ƒç´ ï¼ŒæŠŠåé¢æ»¡è¶³æ¡ä»¶çš„ j éƒ½æ‹›å‡ºæ¥ï¼Œæ”¾å…¥ä¼˜å…ˆé˜Ÿåˆ—
		å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ä»¥ xj ä¸ºå½“å‰è¦å¤„ç†çš„å…ƒç´ 
	3.å°è¯•æ›´æ–°æœ€å¤§å€¼
		å½“å¤„ç† xi æ—¶ï¼Œä¼˜å…ˆé˜Ÿåˆ—ä¸­å°äºç­‰äº ç´¢å¼•i çš„å…ƒç´ ï¼Œéƒ½éœ€è¦æ·˜æ±°æ‰
		ç„¶åå–å †é¡¶å…ƒç´ ä½œä¸º jï¼Œå°è¯•æ›´æ–° maxV
		maxV = maxVal(maxV, yj+xj + yi-xi)
æ€è·¯ï¼šåŒç«¯é˜Ÿåˆ—
	1.ä¸Šé¢æ–¹æ³•æ˜¯é‡‡ç”¨ä¼˜å…ˆé˜Ÿåˆ—â€œæŒ‘é€‰â€å½“å‰æœ€ä¼˜ yj+xj + yi-xi
		æˆ‘ä»¬å¯ä»¥ç”¨å•è°ƒé˜Ÿåˆ—æ¥æŒ‘é€‰ï¼ˆå‡è®¾æ­¤å¤„æˆ‘ä»¬ä»¥ xj ä¸ºå½“å‰è¦å¤„ç†çš„å…ƒç´ ï¼‰
		å› ä¸ºå¯¹äº yj+xj + yi-xiï¼Œå½“å‰å…ƒç´  j æ˜¯å›ºå®šçš„ï¼Œé‚£ä¹ˆ yj+xj å°±æ˜¯å›ºå®šçš„
		åˆ™åªéœ€è¦è€ƒè™‘ä»æ»¡è¶³ yi-xi<=k æ¡ä»¶çš„å…ƒç´ ä¸­ï¼ŒæŒ‘é€‰å‡ºæœ€å¤§çš„ yi-xi
	2.æˆ‘ä»¬å°†æ»¡è¶³ xj-xi<=k çš„å…ƒç´ éƒ½æ”¾å…¥ä¸€ä¸ªåŒç«¯é˜Ÿåˆ— window ä¸­
		2.1.å½“å‰è¦å¤„ç†çš„å…ƒç´ ä¸º j æ—¶ï¼Œå…ˆæ·˜æ±°æ‰æ»¡è¶³ xj - xi > k çš„å…ƒç´  i
		2.2.ä»¥ j ä¸ºå½“å‰å…ƒç´ ï¼Œå°è¯•æ›´æ–°æœ€å¤§å€¼
			i å…ƒç´ ä¸º window ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ 
		2.3.æ­¤æ—¶è¿˜éœ€è¦æŠŠ j æ”¾å…¥ window ä¸­ï¼Œä¸ºåç»­æœºé€‰ä¸­ä½œä¸ºå…ƒç´  i ä½¿ç”¨
			è€Œæ ¹æ® 1. åˆ†æï¼Œwindow é˜Ÿå°¾æ»¡è¶³ yi-xi <= yj-yi çš„éƒ½éœ€è¦æ·˜æ±°æ‰
			ä¹Ÿå°±æ˜¯è¯´ window å…¶å®æ˜¯ä¸€ä¸ªå•è°ƒé€’å‡çš„åŒç«¯é˜Ÿåˆ—
*/
// leetcode submit region begin(Prohibit modification and deletion)
func findMaxValueOfEquation(points [][]int, k int) int {
	// åŒç«¯é˜Ÿåˆ—
	maxVal := func(a, b int) int {
		if a > b {
			return a
		}
		return b
	}
	maxV, window := math.MinInt32, make([]int, 0)
	for idx, p := range points {
		i, j := 0, len(window)
		for sub := p[0] - k; i < j && sub > points[window[i]][0]; {
			i++
		} // å·¦æ·˜æ±°ï¼šxj - xi > kï¼ˆæ³¨é‡Šä¸­çš„ i j æŒ‡çš„æ˜¯é¢˜æ„ä¸­çš„ i jï¼‰
		if i < j { // å°è¯•æ›´æ–°æœ€å¤§å€¼
			maxV = maxVal(maxV, p[0]+p[1]-points[window[i]][0]+points[window[i]][1])
		}
		for sub := p[1] - p[0]; j > i && sub >= points[window[j-1]][1]-points[window[j-1]][0]; {
			j--
		} // å³æ·˜æ±°ï¼šyj - xj >= yj - yi
		window = append(window[i:j], idx) // å³æ·»åŠ ï¼šå½“å‰å…ƒç´ çš„ç´¢å¼• j
	}
	return maxV

	// ä¼˜å…ˆé˜Ÿåˆ—
	//maxVal := func(a, b int) int {
	//	if a > b {
	//		return a
	//	}
	//	return b
	//}
	//maxV, j, n := math.MinInt32, 1, len(points)
	//h := eq{}
	//for i, p := range points {
	//	for h.Len() > 0 && h[0][1] <= i { // å·²â€œè¿‡æœŸâ€çš„å…ƒç´ éœ€è¦æ·˜æ±°
	//		heap.Pop(&h)
	//	}
	//	j = maxVal(j, i+1) // æ›´æ–° j
	//	for v := p[0] + k; j < n && v >= points[j][0]; j++ {
	//		heap.Push(&h, [2]int{points[j][0] + points[j][1], j})
	//	} // æ»¡è¶³ xj-xi<=k çš„å…ƒç´  jï¼Œéƒ½æ”¾å…¥ä¼˜å…ˆé˜Ÿåˆ—
	//	if h.Len() > 0 { // å°è¯•æ›´æ–°æœ€å¤§å€¼
	//		maxV = maxVal(maxV, h[0][0]+p[1]-p[0])
	//	}
	//}
	//return maxV
}

type eq [][2]int

func (e eq) Len() int {
	return len(e)
}

func (e eq) Less(i, j int) bool {
	return e[i][0] > e[j][0]
}

func (e eq) Swap(i, j int) {
	e[i], e[j] = e[j], e[i]
}

func (e *eq) Push(x any) {
	*e = append(*e, x.([2]int))
}

func (e *eq) Pop() any {
	v := (*e)[len(*e)-1]
	*e = (*e)[:len(*e)-1]
	return v
}

//leetcode submit region end(Prohibit modification and deletion)
