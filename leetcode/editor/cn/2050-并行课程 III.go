//ç»™ä½ ä¸€ä¸ªæ•´æ•° n ï¼Œè¡¨ç¤ºæœ‰ n èŠ‚è¯¾ï¼Œè¯¾ç¨‹ç¼–å·ä» 1 åˆ° n ã€‚åŒæ—¶ç»™ä½ ä¸€ä¸ªäºŒç»´æ•´æ•°æ•°ç»„ relations ï¼Œå…¶ä¸­ relations[j] = [
//prevCoursej, nextCoursej] ï¼Œè¡¨ç¤ºè¯¾ç¨‹ prevCoursej å¿…é¡»åœ¨è¯¾ç¨‹ nextCoursej ä¹‹å‰ å®Œæˆï¼ˆå…ˆä¿®è¯¾çš„å…³ç³»ï¼‰ã€‚åŒæ—¶ç»™ä½ ä¸€ä¸ªä¸‹
//æ ‡ä» 0 å¼€å§‹çš„æ•´æ•°æ•°ç»„ time ï¼Œå…¶ä¸­ time[i] è¡¨ç¤ºå®Œæˆç¬¬ (i+1) é—¨è¯¾ç¨‹éœ€è¦èŠ±è´¹çš„ æœˆä»½ æ•°ã€‚
//
// è¯·ä½ æ ¹æ®ä»¥ä¸‹è§„åˆ™ç®—å‡ºå®Œæˆæ‰€æœ‰è¯¾ç¨‹æ‰€éœ€è¦çš„ æœ€å°‘ æœˆä»½æ•°ï¼š
//
//
// å¦‚æœä¸€é—¨è¯¾çš„æ‰€æœ‰å…ˆä¿®è¯¾éƒ½å·²ç»å®Œæˆï¼Œä½ å¯ä»¥åœ¨ ä»»æ„ æ—¶é—´å¼€å§‹è¿™é—¨è¯¾ç¨‹ã€‚
// ä½ å¯ä»¥ åŒæ—¶ ä¸Š ä»»æ„é—¨è¯¾ç¨‹ ã€‚
//
//
// è¯·ä½ è¿”å›å®Œæˆæ‰€æœ‰è¯¾ç¨‹æ‰€éœ€è¦çš„ æœ€å°‘ æœˆä»½æ•°ã€‚
//
// æ³¨æ„ï¼šæµ‹è¯•æ•°æ®ä¿è¯ä¸€å®šå¯ä»¥å®Œæˆæ‰€æœ‰è¯¾ç¨‹ï¼ˆä¹Ÿå°±æ˜¯å…ˆä¿®è¯¾çš„å…³ç³»æ„æˆä¸€ä¸ªæœ‰å‘æ— ç¯å›¾ï¼‰ã€‚
//
//
//
// ç¤ºä¾‹ 1:
//
//
//
// è¾“å…¥ï¼šn = 3, relations = [[1,3],[2,3]], time = [3,2,5]
//è¾“å‡ºï¼š8
//è§£é‡Šï¼šä¸Šå›¾å±•ç¤ºäº†è¾“å…¥æ•°æ®æ‰€è¡¨ç¤ºçš„å…ˆä¿®å…³ç³»å›¾ï¼Œä»¥åŠå®Œæˆæ¯é—¨è¯¾ç¨‹éœ€è¦èŠ±è´¹çš„æ—¶é—´ã€‚
//ä½ å¯ä»¥åœ¨æœˆä»½ 0 åŒæ—¶å¼€å§‹è¯¾ç¨‹ 1 å’Œ 2 ã€‚
//è¯¾ç¨‹ 1 èŠ±è´¹ 3 ä¸ªæœˆï¼Œè¯¾ç¨‹ 2 èŠ±è´¹ 2 ä¸ªæœˆã€‚
//æ‰€ä»¥ï¼Œæœ€æ—©å¼€å§‹è¯¾ç¨‹ 3 çš„æ—¶é—´æ˜¯æœˆä»½ 3 ï¼Œå®Œæˆæ‰€æœ‰è¯¾ç¨‹æ‰€éœ€æ—¶é—´ä¸º 3 + 5 = 8 ä¸ªæœˆã€‚
//
//
// ç¤ºä¾‹ 2ï¼š
//
//
//
// è¾“å…¥ï¼šn = 5, relations = [[1,5],[2,5],[3,5],[3,4],[4,5]], time = [1,2,3,4,5]
//è¾“å‡ºï¼š12
//è§£é‡Šï¼šä¸Šå›¾å±•ç¤ºäº†è¾“å…¥æ•°æ®æ‰€è¡¨ç¤ºçš„å…ˆä¿®å…³ç³»å›¾ï¼Œä»¥åŠå®Œæˆæ¯é—¨è¯¾ç¨‹éœ€è¦èŠ±è´¹çš„æ—¶é—´ã€‚
//ä½ å¯ä»¥åœ¨æœˆä»½ 0 åŒæ—¶å¼€å§‹è¯¾ç¨‹ 1 ï¼Œ2 å’Œ 3 ã€‚
//åœ¨æœˆä»½ 1ï¼Œ2 å’Œ 3 åˆ†åˆ«å®Œæˆè¿™ä¸‰é—¨è¯¾ç¨‹ã€‚
//è¯¾ç¨‹ 4 éœ€åœ¨è¯¾ç¨‹ 3 ä¹‹åå¼€å§‹ï¼Œä¹Ÿå°±æ˜¯ 3 ä¸ªæœˆåã€‚è¯¾ç¨‹ 4 åœ¨ 3 + 4 = 7 æœˆå®Œæˆã€‚
//è¯¾ç¨‹ 5 éœ€åœ¨è¯¾ç¨‹ 1ï¼Œ2ï¼Œ3 å’Œ 4 ä¹‹åå¼€å§‹ï¼Œä¹Ÿå°±æ˜¯åœ¨ max(1,2,3,7) = 7 æœˆå¼€å§‹ã€‚
//æ‰€ä»¥å®Œæˆæ‰€æœ‰è¯¾ç¨‹æ‰€éœ€çš„æœ€å°‘æ—¶é—´ä¸º 7 + 5 = 12 ä¸ªæœˆã€‚
//
//
//
//
// æç¤ºï¼š
//
//
// 1 <= n <= 5 * 10â´
// 0 <= relations.length <= min(n * (n - 1) / 2, 5 * 10â´)
// relations[j].length == 2
// 1 <= prevCoursej, nextCoursej <= n
// prevCoursej != nextCoursej
// æ‰€æœ‰çš„å…ˆä¿®è¯¾ç¨‹å¯¹ [prevCoursej, nextCoursej] éƒ½æ˜¯ äº’ä¸ç›¸åŒ çš„ã€‚
// time.length == n
// 1 <= time[i] <= 10â´
// å…ˆä¿®è¯¾ç¨‹å›¾æ˜¯ä¸€ä¸ªæœ‰å‘æ— ç¯å›¾ã€‚
//
//
// Related Topics å›¾ æ‹“æ‰‘æ’åº æ•°ç»„ åŠ¨æ€è§„åˆ’ ğŸ‘ 32 ğŸ‘ 0

package main

import (
	"fmt"
)

func main() {
	n := 5
	relations := [][]int{{1, 5}, {2, 5}, {3, 5}, {3, 4}, {4, 5}}
	time := []int{1, 2, 3, 4, 5}
	i := minimumTime(n, relations, time)
	fmt.Println(i)
}

/*
æ€è·¯ï¼škahn+ä¼˜å…ˆé˜Ÿåˆ—
	1.è¯¾ç¨‹ä¹‹é—´çš„å…³ç³»ï¼Œå¯ä»¥ç”¨æ‹“æ‰‘æ’åºç›´è§‚çš„å±•ç¤º
		æˆ‘ä»¬å¯ä»¥è´ªå¿ƒçš„é€‰æ‹©å½“å‰æ‰€ä¿®è¯¾ç¨‹ä¸­ï¼Œæœ€å…ˆèƒ½ä¿®å®Œçš„è¯¾ç¨‹ï¼Œçœ‹å®ƒçš„æ‹“æ‰‘æ’åºå…³ç³»ä¸­ï¼Œå“ªäº›è¯¾ç¨‹æ˜¯å¯é€‰çš„ä¸‹ä¸€é—¨è¯¾
		æœ€å…ˆä¿®å®Œçš„è¯¾ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ ä¼˜å…ˆé˜Ÿåˆ— æ¥é€‰æ‹©ï¼ˆæ ¹æ® time åŠ ä¸Šå…¶å¼€å§‹ä¿®çš„æ—¶é—´ï¼‰
		å¦å¤–é€‰æ‹© kahn æ‹“æ‰‘æ’åºç®—æ³•ï¼Œè®°å½•æ¯é—¨è¯¾ç¨‹çš„å…¥åº¦ï¼Œå½“å…¥åº¦ä¸º 0 æ—¶ï¼Œè¯´æ˜è¿™é—¨è¯¾ç¨‹å½“å‰å¯ä¿®
	2.å…·ä½“å®ç°
		adjï¼šé‚»æ¥è¡¨è®°å½•å…ˆä¿®å…³ç³»å›¾çš„
		kahnï¼šè®°å½•æ¯é—¨è¯¾ç¨‹çš„å…¥åº¦
			å½“æŸä¸ªè¯¾ç¨‹ä¿®å®Œæ—¶ï¼Œæˆ‘ä»¬éå†è¿™é—¨è¯¾ç¨‹çš„åä¿®è¯¾ç¨‹ï¼ˆé‚»æ¥è¡¨ï¼‰
			å°†æ¯é—¨åä¿®è¯¾ç¨‹ i çš„å…¥åº¦ -1ï¼Œkahn[i] è¡¨ç¤ºçš„å°±æ˜¯ ç¬¬ié—¨è¯¾ çš„å…ˆä¿®è¯¾ç¨‹è¿˜æœ‰ kahn[i] é—¨
			å½“ kahn[i]==0 æ—¶ï¼Œè¯´æ˜è¿™é—¨è¯¾ç¨‹çš„å…ˆä¿®è¯¾éƒ½ä¿®å®Œäº†ï¼Œæ­¤æ—¶å°†è¿™é—¨è¯¾åŠ å…¥ ä¼˜å…ˆé˜Ÿåˆ— ä¸­
		thï¼šè‡ªå®šä¹‰çš„å°é¡¶å †ï¼Œç”¨äºé€‰æ‹©å½“å‰æœ€å…ˆä¿®å®Œçš„è¯¾ç¨‹
æ€è·¯ï¼škahn+dp
	1.å¯¹äºä»»æ„è¯¾ç¨‹ i
		å› ä¸ºå¿…é¡»ä¿®å®Œå®ƒçš„æ‰€æœ‰å…ˆä¿®è¯¾ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä»å®ƒçš„å…ˆä¿®è¯¾ç¨‹ä¸­ï¼Œé€‰å‡ºä¿®å®Œç”¨æ—¶æœ€å¤šçš„è¯¾ç¨‹
		ä½œä¸º i å¼€å§‹ä¿®çš„èµ·ç‚¹
		ä¹Ÿå°±æ˜¯å¯¹ä¸Šè¿°æ–¹æ¡ˆï¼ˆkahn+ä¼˜å…ˆé˜Ÿåˆ—ï¼‰çš„ä¸€ç§ä¼˜åŒ–ï¼Œä½¿ç”¨é˜Ÿåˆ—æ¥ä»£æ›¿ä¼˜å…ˆé˜Ÿåˆ—
	2.çŠ¶æ€è½¬ç§»æ–¹ç¨‹
		dp[i] = maxVal(dp[i], dp[curr])
			dp[i] å³ä¸‹ä¸€é—¨å¯èƒ½è¦ä¿®çš„è¯¾ç¨‹
			dp[curr] å³å½“å‰ä¿®å®Œçš„è¯¾ç¨‹ï¼Œå½“ curr ä¿®å®Œåï¼Œæˆ‘ä»¬å°è¯•æ›´æ–°å¼€å§‹ä¿®ä¸‹ä¸€é—¨è¯¾ç¨‹çš„æ—¶é—´
		i çš„æ¯ä¸€é—¨å…ˆä¿®è¯¾ç¨‹ç»“æŸæ—¶ï¼Œéƒ½ä¼šå°è¯•æ›´æ–° i çš„èµ·ä¿®æ—¶é—´
*/
// leetcode submit region begin(Prohibit modification and deletion)
func minimumTime(n int, relations [][]int, time []int) int {
	// dpï¼škahn+ä¼˜å…ˆé˜Ÿåˆ— çš„ä¼˜åŒ–
	maxVal := func(a, b int) int {
		if a > b {
			return a
		}
		return b
	}
	cnt := 0
	kahn, adj := make([]int, n), make([][]int, n)
	for _, edge := range relations {
		adj[edge[0]-1] = append(adj[edge[0]-1], edge[1]-1) // åˆå§‹åŒ–é‚»æ¥è¡¨
		kahn[edge[1]-1]++                                  // åˆå§‹åŒ– kahn
	}
	queue, dp := make([]int, 0), make([]int, n) // dp è®°å½•æ¯é—¨è¯¾éœ€ä¿®å®Œçš„æ—¶é—´
	for i := 0; i < n; i++ {
		if kahn[i] == 0 {
			queue = append(queue, i) // åˆå§‹åŒ–é˜Ÿåˆ—
		}
	}
	for len(queue) > 0 {
		curr := queue[0]
		queue = queue[1:]           // ä¿®å®Œä¸€é—¨è¯¾
		dp[curr] += time[curr]      // è¯¾ç¨‹ä¿®å®Œï¼Œæ›´æ–°æ—¶é—´
		cnt = maxVal(cnt, dp[curr]) // è®°å½•å½“å‰æœ€åä¸€é—¨è¯¾çš„æ—¶é•¿
		for _, i := range adj[curr] {
			dp[i] = maxVal(dp[i], dp[curr]) // æ›´æ–° i é—¨çš„ä¿®å®Œæ—¶é—´
			if kahn[i]--; kahn[i] == 0 {
				queue = append(queue, i) // å¼€å§‹ä¿®ä¸€é—¨è¯¾
			}
		}
	}
	return cnt

	// kahn+å †ï¼šä¸ªäºº
	//cnt := 0
	//h, kahn, adj := &th{}, make([]int, n+1), make([][]int, n+1)
	//for _, edge := range relations {
	//	adj[edge[0]] = append(adj[edge[0]], edge[1]) // åˆå§‹åŒ–é‚»æ¥è¡¨
	//	kahn[edge[1]]++                              // åˆå§‹åŒ– kahn
	//}
	//for i := 1; i <= n; i++ {
	//	if kahn[i] == 0 {
	//		heap.Push(h, [2]int{i, time[i-1]}) // åˆå§‹åŒ–ä¼˜å…ˆé˜Ÿåˆ—
	//	}
	//}
	//for h.Len() > 0 {
	//	top := heap.Pop(h).([2]int)     // æœ€å…ˆä¿®å®Œçš„è¯¾ç¨‹
	//	cnt = top[1]                    // å½“å‰èŠ±è´¹æ—¶é—´
	//	for _, i := range adj[top[0]] { // ä¸‹ä¸€é—¨å¯ä¿®è¯¾ç¨‹ï¼šæ‹“æ‰‘æ’åº
	//		kahn[i]--         // å…¥åº¦ -1
	//		if kahn[i] == 0 { // å…¥åº¦ä¸º 0
	//			heap.Push(h, [2]int{i, cnt + time[i-1]}) // ä¿®ä¸‹é—¨è¯¾ç¨‹
	//		}
	//	}
	//}
	//return cnt
}

type th [][2]int

func (t th) Len() int {
	return len(t)
}
func (t th) Less(i, j int) bool {
	return t[i][1] < t[j][1]
}
func (t th) Swap(i, j int) {
	t[i], t[j] = t[j], t[i]
}
func (t *th) Push(x any) {
	*t = append(*t, x.([2]int))
}
func (t *th) Pop() any {
	last := (*t)[len(*t)-1]
	*t = (*t)[:len(*t)-1]
	return last
}

//leetcode submit region end(Prohibit modification and deletion)
