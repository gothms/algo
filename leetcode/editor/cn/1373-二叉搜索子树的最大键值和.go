//ç»™ä½ ä¸€æ£µä»¥ root ä¸ºæ ¹çš„ äºŒå‰æ ‘ ï¼Œè¯·ä½ è¿”å› ä»»æ„ äºŒå‰æœç´¢å­æ ‘çš„æœ€å¤§é”®å€¼å’Œã€‚
//
// äºŒå‰æœç´¢æ ‘çš„å®šä¹‰å¦‚ä¸‹ï¼š
//
//
// ä»»æ„èŠ‚ç‚¹çš„å·¦å­æ ‘ä¸­çš„é”®å€¼éƒ½ å°äº æ­¤èŠ‚ç‚¹çš„é”®å€¼ã€‚
// ä»»æ„èŠ‚ç‚¹çš„å³å­æ ‘ä¸­çš„é”®å€¼éƒ½ å¤§äº æ­¤èŠ‚ç‚¹çš„é”®å€¼ã€‚
// ä»»æ„èŠ‚ç‚¹çš„å·¦å­æ ‘å’Œå³å­æ ‘éƒ½æ˜¯äºŒå‰æœç´¢æ ‘ã€‚
//
//
//
//
// ç¤ºä¾‹ 1ï¼š
//
//
//
//
//è¾“å…¥ï¼šroot = [1,4,3,2,4,2,5,null,null,null,null,null,null,4,6]
//è¾“å‡ºï¼š20
//è§£é‡Šï¼šé”®å€¼ä¸º 3 çš„å­æ ‘æ˜¯å’Œæœ€å¤§çš„äºŒå‰æœç´¢æ ‘ã€‚
//
//
// ç¤ºä¾‹ 2ï¼š
//
//
//
//
//è¾“å…¥ï¼šroot = [4,3,null,1,2]
//è¾“å‡ºï¼š2
//è§£é‡Šï¼šé”®å€¼ä¸º 2 çš„å•èŠ‚ç‚¹å­æ ‘æ˜¯å’Œæœ€å¤§çš„äºŒå‰æœç´¢æ ‘ã€‚
//
//
// ç¤ºä¾‹ 3ï¼š
//
//
//è¾“å…¥ï¼šroot = [-4,-2,-5]
//è¾“å‡ºï¼š0
//è§£é‡Šï¼šæ‰€æœ‰èŠ‚ç‚¹é”®å€¼éƒ½ä¸ºè´Ÿæ•°ï¼Œå’Œæœ€å¤§çš„äºŒå‰æœç´¢æ ‘ä¸ºç©ºã€‚
//
//
// ç¤ºä¾‹ 4ï¼š
//
//
//è¾“å…¥ï¼šroot = [2,1,3]
//è¾“å‡ºï¼š6
//
//
// ç¤ºä¾‹ 5ï¼š
//
//
//è¾“å…¥ï¼šroot = [5,4,8,3,null,6,3]
//è¾“å‡ºï¼š7
//
//
//
//
// æç¤ºï¼š
//
//
// æ¯æ£µæ ‘æœ‰ 1 åˆ° 40000 ä¸ªèŠ‚ç‚¹ã€‚
// æ¯ä¸ªèŠ‚ç‚¹çš„é”®å€¼åœ¨ [-4 * 10^4 , 4 * 10^4] ä¹‹é—´ã€‚
//
//
// Related Topics æ ‘ æ·±åº¦ä¼˜å…ˆæœç´¢ äºŒå‰æœç´¢æ ‘ åŠ¨æ€è§„åˆ’ äºŒå‰æ ‘ ğŸ‘ 120 ğŸ‘ 0

package main

import (
	"math"
)

func main() {

}

/*
æ€è·¯ï¼šé‡‡ç”¨ dfs çš„è¦ç‚¹
	1.ä»»ä¸€èŠ‚ç‚¹ curr å¯¹åº”çš„äºŒå‰æ ‘æ˜¯äºŒå‰æœç´¢æ ‘çš„æ¡ä»¶æ˜¯ï¼šå·¦ã€å³å­æ ‘éƒ½æ˜¯äºŒå‰æœç´¢æ ‘
		å½“å·¦ã€å³å­æ ‘çš„èŠ‚ç‚¹çš„ Val èŒƒå›´åˆ†åˆ«æ˜¯ [minl,maxl] å’Œ [minr,maxr] æ—¶ï¼Œè‹¥ curr ä¸º äºŒå‰æœç´¢æ ‘ï¼Œæœ‰ï¼š
			curr.Val > maxlï¼šå¤§äºå·¦å­æ ‘èŠ‚ç‚¹ Val çš„æœ€å¤§å€¼
			curr.Val < minrï¼šå°äºå³å­æ ‘èŠ‚ç‚¹ Val çš„æœ€å°å€¼
		è€Œè¦æ»¡è¶³ä¸Šè¿°æ¡ä»¶ï¼Œåªæœ‰åœ¨åˆ†åˆ«éå†äº† curr çš„å·¦å³å­æ ‘ï¼Œæ˜¯å¦æ˜¯äºŒå‰æœç´¢æ ‘åï¼Œæ‰å¯ä»¥è¿›è¡Œä¸Šè¿°ä¸¤å¯¹å€¼çš„æ¯”è¾ƒ
			æ‰€ä»¥å½“é‡‡ç”¨ dfs æ¥è§£å†³æ­¤é¢˜æ—¶ï¼Œéœ€è¦å°†å­æ ‘çš„ Val å–å€¼åŒºé—´èŒƒå›´è¿”å›
			ä¹Ÿå°±æ˜¯ [minl,maxl] å’Œ [minr,maxr]
	2.å½“ä¸€ä¸ªèŠ‚ç‚¹æ˜¯å¶å­èŠ‚ç‚¹ leaf æ—¶ï¼Œæ€ä¹ˆå¤„ç†è¿”å›å€¼é—®é¢˜ï¼Ÿ
		å¾ˆæ˜¾ç„¶ï¼Œå½“ä¸€ä¸ª leaf èŠ‚ç‚¹è¿”å›æ—¶ï¼Œå®ƒçš„ Val å–å€¼åŒºé—´æ˜¯ [leaf.Val,leaf.Val]
		ä½†æ˜¯åœ¨ dfs ä¸­ï¼Œæ€ä¹ˆå¤„ç† leaf çš„ä¸¤ä¸ª nil å­èŠ‚ç‚¹ï¼Ÿå¯é¢„è§çš„æ–¹å¼æœ‰ä¸¤ç§
		2.1.å½“ä¸€ä¸ªèŠ‚ç‚¹çš„å­èŠ‚ç‚¹æ˜¯ nil æ—¶ï¼Œä¸å¾€ä¸‹éå† nil èŠ‚ç‚¹ï¼Œè€Œæ˜¯æå‰åˆ¤æ–­æ˜¯å·¦å³å­èŠ‚ç‚¹å¦ä¸º nil
			a)å½“ curr.left == nil && curr.right == nilï¼Œcurr ä¸º leaf èŠ‚ç‚¹ï¼Œè¿”å› [curr.Val,curr.Val]
			b)å½“ curr.left == nil && curr.right != nilï¼Œåˆ™è¿”å›çš„ minl = curr.Val
				curr.right == nil && curr.left != nilï¼ŒåŒç†
			c)å·¦å³å­èŠ‚ç‚¹å‡ä¸ä¸º nilï¼Œåˆ™ä»å·¦å³è¿”å›çš„ [minl,maxl] å’Œ [minr,maxr]ï¼Œå– [minl,maxr] è¿”å›
			è¿™3ç§æƒ…å†µï¼Œéƒ½æ˜¯ curr å¯¹åº”çš„äºŒå‰æ ‘æ˜¯äºŒå‰æœç´¢æ ‘
		2.2.ä¸åˆ¤æ–­å½“å‰ curr èŠ‚ç‚¹çš„å·¦å³èŠ‚ç‚¹æ˜¯å¦ä¸º nil
			è¿™ç§å¤„ç†æ–¹å¼çš„å¥½å¤„æ˜¯ï¼Œä¸ä¼šå¸¦æ¥å­èŠ‚ç‚¹ä¸º nil çš„å„ç§æƒ…å†µåˆ¤æ–­
			åå¤„æ˜¯ï¼šï¼ˆè¯¦è§ä»£ç ï¼‰
				å½“ curr == nil æ—¶ï¼Œè¿”å› [math.MaxInt32, math.MinInt32]
				åˆ™å¤„ç† 2.1.c çš„æƒ…å†µæ—¶ï¼Œéœ€è¦å°æŠ€å·§æ¥è¿”å› [minl,maxr]
	3.å‡è®¾æ‰€æ±‚å€¼ äºŒå‰æœç´¢æ ‘æœ€å¤§å’Œ ä¸º maxSum
		ç”±äºèŠ‚ç‚¹å€¼å¯èƒ½æ˜¯è´Ÿæ•°ï¼Œæ‰€ä»¥å¯èƒ½å­˜åœ¨å½“äºŒå‰æœç´¢æ ‘ curr çš„æœ€å¤§å’Œä¸º sum æ—¶
		curr çš„æŸä¸ª äºŒå‰æœç´¢å­æ ‘ çš„ æœ€å¤§å’Œ > sum
		æ‰€ä»¥éœ€è¦å®æ—¶æ¯”è¾ƒæ¯ä¸ªäºŒå‰æœç´¢æ ‘çš„å’Œï¼Œä»¥æ±‚å‡ºæœ€å¤§å€¼
		è€Œä¸æ˜¯è¿”å›åˆ°æ ¹èŠ‚ç‚¹å†å–å€¼
*/

type TreeNode struct {
	Val   int
	Left  *TreeNode
	Right *TreeNode
}

//leetcode submit region begin(Prohibit modification and deletion)
/**
 * Definition for a binary tree node.
 *
 */
func maxSumBST(root *TreeNode) int {
	maxVal := func(a, b int) int {
		if a > b {
			return a
		}
		return b
	}
	minVal := func(a, b int) int {
		if a < b {
			return a
		}
		return b
	}
	maxSum := 0
	var dfs func(*TreeNode) (int, int, bool, int)
	dfs = func(r *TreeNode) (int, int, bool, int) {
		if r == nil {
			return math.MaxInt32, math.MinInt32, true, 0
		}
		minl, maxl, bstl, vl := dfs(r.Left)
		minr, maxr, bstr, vr := dfs(r.Right)
		if bstl && bstr && r.Val > maxl && r.Val < minr {
			sum := vl + vr + r.Val
			maxSum = maxVal(maxSum, sum)
			return minVal(r.Val, minl), maxVal(r.Val, maxr), true, sum
		}
		return 0, 0, false, 0
	}
	dfs(root)
	return maxSum
}

//leetcode submit region end(Prohibit modification and deletion)
